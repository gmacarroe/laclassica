<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    (function () {
      // Inicialitza EmailJS amb la Public Key
      emailjs.init({
        publicKey: "IKMe_2uHBc0gk0IjO", // Substitueix per la teva Public Key
      });
    })();

    function sendEmail(event) {
      event.preventDefault();

      // Seleccionem el botó
      const button = document.querySelector("button");
      const originalText = button.innerText;

      // Mostrem el text de càrrega
      button.innerText = "Enviant...";
      button.disabled = true;

      // Recollim les dades del formulari
      const nom = document.querySelector('input[name="from_name"]').value;
      const email = document.querySelector('input[name="reply_to"]').value;
      const missatge = document.querySelector('textarea[name="message"]').value;

      // Enviem el correu a través d'EmailJS
      emailjs.send("service_classik-mail", "template_classik-mail", {
        from_name: nom, // Nom de l'usuari
        reply_to: email, // Correu de l'usuari per respondre
        message: missatge, // Missatge introduït
      }).then(
        function (response) {
          alert("Missatge enviat correctament! Gràcies pel teu contacte.");
          document.querySelector("form").reset(); // Neteja el formulari
          button.innerText = originalText; // Restaurem el text original
          button.disabled = false; // Rehabilitem el botó
        },
        function (error) {
          console.error("Error:", error); // Registre d'error
          alert("Hi ha hagut un error en enviar el missatge. Torna-ho a provar.");
          button.innerText = originalText; // Restaurem el text original
          button.disabled = false; // Rehabilitem el botó
        }
      );
    }
  </script>
</head>
<body>
  <!-- Header -->
  <header class="navbar">
    <h1>ClàssiK - Cultura irreverent</h1>
    <nav>
      <ul>
        <li><a href="index.html">Inici</a></li>
        <li><a href="qui_som.html">Qui som</a></li>
        <li><a href="catalog.html">Catàleg</a></li>
        <li><a href="contacte.html" class="active">Contacte</a></li>
      </ul>
    </nav>
  </header>

  <!-- Contacte -->
  <section class="contacte">
    <h2>Contacta amb nosaltres</h2>
    <form onsubmit="sendEmail(event)">
      <input type="text" name="from_name" placeholder="El teu nom" required>
      <input type="email" name="reply_to" placeholder="El teu correu" required>
      <textarea name="message" placeholder="El teu missatge" required></textarea>
      <button type="submit" class="cta">Envia</button>
    </form>
  </section>

  <!-- Footer -->
  <footer>
    &copy; 2024 ClàssiK. Tots els drets reservats.
  </footer>
</body>
</html>